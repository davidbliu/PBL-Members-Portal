function activateEditable(){$(".editable").attr("contenteditable",!0),$(".editable").unbind("focusin").focusin(function(){editData=$(this).text()}),$(".editable").unbind("focusout").focusout(function(){if($(this).text()!=editData){var i=$(this).parent(),t={};t.id=$(this).parent().attr("data-id"),t[$(this).attr("data-field")]=$(this).text().trim(),$.ajax({url:"/go/update",type:"post",data:t,success:function(t){$(i).fadeOut(100).fadeIn(100)}})}})}function getCheckedPermissions(){var i=[];return $(".permissions-check").each(function(){$(this).is(":checked")&&i.push($(this).attr("data-key"))}),i.join(",")}function activateEditPermissions(){$(".permissions-td").click(function(){var i=$(this).attr("data-permissions").split(",");permissionsEditId=$(this).parent().attr("data-id"),$(".permissions-check").each(function(){$(this).prop("checked",!1)}),_.each(i,function(i){$("#"+i.replace(" ","")+"-checkbox").prop("checked",!0)}),$("#permissions-key").text($(this).attr("data-key")),$("#permissions-edit").show(),$("#black-film").show()}),$("#permissions-cancel").click(function(){$("#permissions-edit").hide(),$("#black-film").hide(),permissionsEditId=null}),$("#permissions-clear").click(function(){$(".permissions-check").each(function(){$(this).prop("checked",!1)})}),$("#permissions-save").click(function(){var i=$("#"+permissionsEditId+"-row");updatedPermissions=getCheckedPermissions(),""==updatedPermissions&&(updatedPermissions="Anyone"),updateData={id:permissionsEditId,groups:updatedPermissions},$.ajax({url:"/go/update",type:"post",data:updateData,success:function(t){$("#"+permissionsEditId+"-permissions-td").text(updatedPermissions),$("#"+permissionsEditId+"-permissions-td").attr("data-permissions",updatedPermissions.replace(" ","")),$(i).fadeOut(100).fadeIn(100),permissionsEditId=null,$("#permissions-edit").hide(),$("#black-film").hide()}})})}function activateDelete(){$(".delete-link").click(function(){id=$(this).attr("data-id"),$.ajax({url:"/go/destroy",type:"post",data:{id:id},success:function(i){$("#"+id+"-row").remove()}})})}var editData,permissionsEditId;activateDelete(),activateEditable(),activateEditPermissions();