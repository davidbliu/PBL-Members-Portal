<style type = 'text/css'>
.golink-card{
	padding:15px;
	margin-bottom:15px;
}
</style>
<h3>You've added a link</h3>
<div class = 'golink-card'>
	<div>
		Key: 
		<input id = 'key-input' type = 'text' class = 'form-control' value = '<%= @golink.key %>' placeholder = 'Key (ex: example-key)'>
	</div>
	<div>
		URL: 
		<input id = 'url-input' type = 'text' class = 'form-control' value = '<%= @golink.url %>' placeholder = 'URL'>
	</div>
	<div>
		Description: 
		<input id = 'description-input' type = 'text' class = 'form-control' value = '<%= @golink.description %>' placeholder = 'Description'>
	</div>
	<div>
		Groups:
		<% @groups.each do |group| %>
			<div>
				<input class = 'golink-group-checkbox' data-key = '<%= group.key %>' type = 'checkbox'> <%= group.get_name %>
			</div>
		<% end %>
	</div>
	<div class = 'btn btn-info' id = 'save-golink-btn'>Update</div>
	<div class = 'btn btn-danger' id = 'delete-golink-btn'>Undo</div>
</div>

<script type = 'text/javascript'>
function getCheckedGroupKeys(){
	var ids = [];
	$('.golink-group-checkbox').each(function(){
		if($(this).is(':checked')){
			ids.push($(this).attr('data-key'));
		}
	});
	return ids;
}
$('#save-golink-btn').click(function(){
	$.ajax({
		url:'/go/update',
		type:'post',
		data:{
			id: <%= raw(@golink.id) %>,
			key: $('#key-input').val(),
			description: $('#description-input').val(),
			url: $('#url-input').val(),
			groups: getCheckedGroupKeys()
		},
		success:function(data){
			window.location = '/go'
		}
	})
});
$('#delete-golink-btn').click(function(){
	$.ajax({
		url:'/go/destroy',
		type:'post', 
		data:{
			id: <%= raw(@golink.id) %>
		},
		success:function(data){
			window.location = '/go'
		}
	})
})
</script>